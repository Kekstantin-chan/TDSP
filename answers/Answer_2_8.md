#### Вопрос 08

##### Решение задачи о разорении

*Условие*: В игре участвуют 2 игрока. Начальный капитал первого игрока равен $z_1>0$, второго игрока - $z_2>0$. Каждую партию игрок выигрывает или проигрывает с вероятностью 1/2 независимо от исходов предыдущих партий, при этом его капитал соответственно увеличивается или уменьшается на единицу. Игроки состязаются до банкротства одного из них. Какова вероятность выигрыша для одного из них? *(Капиталы обоих игроков конечны)*

*Решение*: Введём случайные величины $\xi_k$, изображающие выигрыш первого игрока в $k$-й партии. Очевидно, что $\xi_k$ независимы,

$$\xi_k=
    \begin{cases}
        1 &\text{с вероятностью 1/2}\\
        -1 &\text{с вероятностью 1/2}       
    \end{cases}$$

Число $z_1+S_k=z_1+\sum_{j=1}^k{\xi_j}$ будет означать капитал первого игрока, а $z_2-S_k$ - капитал второго игрока после $k$ партий. Величина

$$\eta=\min{\{k:z_1+S_k=0 \text{ или } z_2-S_k\}}$$

есть время до окончания игры, т.е. до разорения одного из игроков. Спрашивается, чему равна вероятность $P_i$ того, что выигрыает $i$-й игрок($i=1,2$)?

Ясно, что $\eta$ есть марковский момент, при этом $S_{\eta}=-z_1$ с вероятностью $P_2$ и $S_{\eta}=z_2$ с вероятностью $P_1=1-P_2$. Поэтому 

$$MS_{\eta}=P_1z_2-P_2z_1$$

Если $M\eta<\infty$, то в силу тождества Вальда мы имели бы 

$$P_1z_2-P_2z_1=M\eta M\xi_1=0$$

Отсюда находим, что $P_i=z_i/(z_1+z_2)$.

Остаётся проверить конечность $M\eta$. Пусть для простоты $z_1+z_2=2z$ - чётно. С вероятностью $2^{-\min{(z_1,z_2)}}\ge 2^{-z}$ игра может закончиться за $\min{(z_1,z_2)} \le z$ партий. Так как в течение игры суммарный капитал обоих игроков не меняется, то

$$P(\eta>z)\le1-2^{-z},\dotsc,P(\eta>zN)<(1-2^{-z})^N$$

Это, очевидно, влечёт за собой конечность

$$M\eta=\sum_{k=0}^{\infty}P(\eta>k)$$

*Комментарий*: существует ещё как минимум 2 варианта решения данной задачи: аналитический(случайное блуждание на отрезке с поглощением) и на марковских цепях. В вопросе приведено решение через процессы, не зависящие от будущего, так как оно приведено в учебнике Боровкова сразу после разбора двух предыдущих вопросов.

**Другой вариант задачи**:

*Условия*:

Два игрока играют в игру. Игрок $A$ имеет начальный капитал $a$ монет; игрок $B$ имеет начальный капитал $b$ монет. В каждой партии игрок $A$ выигрывает или проигрывает 1 монету относительно $B$. Блуждание происходит на промежутке $[0; a+b]$. $p$ — вероятность выигрыша в партии игрока $A$, $q$ — вероятность выигрыша в партии игрока $B$. Игра идет до тех пора, пока кто то не обанкротится, т.е у кого нибудь останется капитал 0 монет.

Ответим на следующие вопросы. Какая вероятность что выиграет игрок $A$? Как эта вероятность зависит от $p$ и $q$?

*Решение*:

Обозначим вероятность выиграша первого игрока $P_a$, вероятность проигрыша первого игрока - $Q_a$. Зная решение из задаче о блуждании на луче, можем сделать такое рассуждение. Вероятность что *когда нибудь* первый игрок придет из точки *a* в точку 0 равна 
$$
(\frac{q}{p})^a
$$
Заметим факт, что первый игрок может попасть в точку 0 из точки *a* двумя способами:

- Заходя в точку *a + b* (т.е. сначало он победит)
- Не заходя в точку *a + b* (т.е. сразу проиграет)

Это означает что
$$
(\frac{q}{p})^a = Q_a +P_a \cdot (\frac{p}{q})^{a+b}
$$
*Расшифровка*: игрок сразу проиграл ($Q_a$) или выиграл($P_a$) и попал в $a+b$, а потом все проиграл ($(\frac{p}{q})^a$).
$$
(\frac{q}{p})^a = Q_a +P_a \cdot (\frac{p}{q})^{a+b} \\
(\frac{q}{p})^a = 1-P_a +P_a \cdot (\frac{p}{q})^{a+b} \\
P_a[1 - (\frac{q}{p})^{a+b}]=1-(\frac{q}{p})^{a} \\
P_a=\frac{1-(q/p)^a}{1-(q/p)^{a+b}}
$$
Заметим, что при $q=p=1/2$ применем правило Лапитяля(хи-хи) получим, что 
$$
P_a=\frac{a}{a+b}
$$
  *Ответ*:
$$
\begin{cases}
\frac{a}{a+b}, q=p=1/2 \\
\frac{1-(q/p)^a}{1-(q/p)^{a+b}}, q \neq p
\end{cases}
$$
*Другое решение* (кратко):

Воспользуемы формулой полной вероятности. 
$$
\begin{cases}
P_a=P_{a+1}\cdot p + P_{a-1} \cdot q \\
P_0=0 \\
P_{a+b}=1
\end{cases}
$$
Решив данное уравнение, мы получим тот же самый ответ как и выше.

