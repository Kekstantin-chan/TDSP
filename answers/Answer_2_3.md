#### Вопрос 03

##### Случайные блуждания на отрезке. Задача о разорении.

Блуждание на отрезке - классический пример случайного процесса. Частица начинает движение из точки начала координат ($x = 0$) и с равными вероятностями сдвигается влево или вправо на один шаг. 

Блуждание на отрезке частный случай блуждания на луче. Теперь есть 2 границы: верхняя и нижняя.

Блуждание на отрезке лежит в основе задачи о разорении. 

**Пример задачи:**

*Условия*:

Два игрока играют в игру. Игрок $A$ имеет начальный капитал $a$ монет; игрок $B$ имеет начальный капитал $b$ монет. В каждой партии игрок $A$ выигрывает или проигрывает 1 монету относительно $B$. Блуждание происходит на промежутке $[0; a+b]$. $p$ — вероятность выигрыша в партии игрока $A$, $q$ — вероятность выигрыша в партии игрока $B$. Игра идет до тех пора, пока кто то не обанкротится, т.е у кого нибудь останется капитал 0 монет.

Ответим на следующие вопросы. Какая вероятность что выиграет игрок $A$? Как эта вероятность зависит от $p$ и $q$?

*Решение*:

Обозначим вероятность выиграша первого игрока $P_a$, вероятность проигрыша первого игрока - $Q_a$. Зная решение из задаче о блуждании на луче, можем сделать такое рассуждение. Вероятность что *когда нибудь* первый игрок придет из точки *a* в точку 0 равна 
$$
(\frac{q}{p})^a
$$
Заметим факт, что первый игрок может попасть в точку 0 из точки *a* двумя способами:

- Заходя в точку *a + b* (т.е. сначало он победит)
- Не заходя в точку *a + b* (т.е. сразу проиграет)

Это означает что
$$
(\frac{q}{p})^a = Q_a +P_a \cdot (\frac{p}{q})^{a+b}
$$
*Расшифровка*: игрок сразу проиграл ($Q_a$) или выиграл($P_a$) и попал в $a+b$, а потом все проиграл ($(\frac{p}{q})^a$).
$$
(\frac{q}{p})^a = Q_a +P_a \cdot (\frac{p}{q})^{a+b} \\
(\frac{q}{p})^a = 1-P_a +P_a \cdot (\frac{p}{q})^{a+b} \\
P_a[1 - (\frac{q}{p})^{a+b}]=1-(\frac{q}{p})^{a} \\
P_a=\frac{1-(q/p)^a}{1-(q/p)^{a+b}}
$$
Заметим, что при $q=p=1/2$ после применения правила Лапитяля(хи-хи) получится, что 
$$
P_a=\frac{a}{a+b}
$$
  *Ответ*:
$$
\begin{cases}
\frac{a}{a+b}, q=p=1/2 \\
\frac{1-(q/p)^a}{1-(q/p)^{a+b}}, q \neq p
\end{cases}
$$
*Другое решение не через задачу с лучом* (кратко):

Воспользуемся формулой полной вероятности. 
$$
\begin{cases}
P_a=P_{a+1}\cdot p + P_{a-1} \cdot q \\
P_0=0 \\
P_{a+b}=1
\end{cases}
$$
Решив данную систему, мы получим тот же самый ответ как и выше.

